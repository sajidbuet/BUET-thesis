% Be careful about changing styles
\RequirePackage{graphicx}
\RequirePackage{algorithmic}
\RequirePackage{algorithm}
\RequirePackage{mathtools}
\RequirePackage{amsthm}
\RequirePackage{amssymb}
\RequirePackage{amsmath}
\RequirePackage[a4paper, top=1.25in, bottom=1.0in, left=1.5in, right=1.0in]{geometry}
\RequirePackage{times}
\RequirePackage{cite}
\RequirePackage{url}
\RequirePackage{listings}
\RequirePackage{multirow}
\RequirePackage{svg}
%\RequirePackage[acronym]{glossaries}
\RequirePackage[nopostdot,style=super,nonumberlist,toc]{glossaries}

\RequirePackage[final, colorlinks, linkcolor=black, citecolor=blue, urlcolor=black]{hyperref}

% Prevent math from being upcased
% http://tex.stackexchange.com/questions/46525/preventing-makeuppercase-from-affecting-mathematics
\RequirePackage{textcase}

% For index creation
\RequirePackage{imakeidx}

% Version information at the end
\RequirePackage[nofancy,notoday]{rcsinfo}
\rcsInfo $Id: buetugthesis.sty,v 2.0 2025/06/09 13:23:11 sajid Exp $
\RequirePackage{datetime}

% Automatic abbreviation: convert full names like "Sajid Muhaimin Choudhury" -> "SM Choudhury"
% Requires: 
\RequirePackage{xstring}
\RequirePackage{datatool}


\makeglossaries
  
% Definition macros

\def\buet{Bangladesh University of Engineering and Technology}


% sets spacing between paragraphs
\parskip 2.5mm           

% Clever referencing
\RequirePackage{cleveref}

% Caption setup
\RequirePackage{caption} 
\captionsetup[table]{skip=2.50mm}

% 1.5 spacing
\RequirePackage{setspace}
\onehalfspacing
\RequirePackage{xspace}

% sets leading space for paragraphs
\parindent 0.0mm		  


% Read and store student names in DB
\RequirePackage{datatool}
\DTLloaddb[noheader]{Supervisor}{parameters/supervisor.txt}
\DTLloaddb[noheader]{BOE}{parameters/boe.txt}

% Thesis parameters



% Thesis title page 
\def\thesistitlepage{
  \thispagestyle{empty}
  \begin{center}
    \vspace*{\stretch{2}}
    \textbf{\Large{\thesistitle}}

    \vspace*{\stretch{5}}
    {\large by}\\
    \vspace*{\stretch{1}}\large{\author}\\ 
    \large \StudentID\\
    \vspace*{\stretch{3}}
    
    {\large \MakeUppercase\degree}\\
    {\large IN \\ \MakeUppercase\subject}\\
    \vspace*{\stretch{4}}{\tiny.}\vspace*{\stretch{2}}
    %\includegraphics[width=40mm]{figures/buetlogo}\\
    \includesvg[width=30mm]{figures/BUET_logo_original.svg}\\
    \large \department\\
    {\large \buet}\\
    \medskip
    Dhaka, Bangladesh\\

    \bigskip
    \vspace*{\stretch{1}}
    \thesisdefensemonthyear
  \end{center}
}



% Thesis certification page
\def\thesiscertificationpage{
   \addcontentsline{toc}{chapter}{\textbf{Certification}}
   
  The thesis titled, \textbf{\lq\lq\thesistitle\rq\rq}, submitted by
 \textbf{\author}, Roll No.: \StudentID , Session  \session, has been accepted as satisfactory in partial fulfillment of the requirements for the degree of \degree ~in \subject\hphantom -on \thesisdefenseday ~ \thesisdefensemonthyear.
  
  
  \begin{center}
  	\textbf{{\large BOARD OF EXAMINERS}}\vspace*{1.0mm}
  \end{center}
  
  \hspace*{4.0mm}\begin{minipage}[t]{0.9\textwidth}
    \DTLforeach{BOE}{\ExaminerName=Column1,
    				 \ExaminerRole=Column2,
    				 \ExaminerDesignation=Column3,
    				 \ExaminerStatus=Column4,
    			     \ExaminerAddress=Column5}
    			{
                    \vspace*{10.0mm}
    					\rule{5cm}{.3mm}\\
    					\ExaminerName \hfill \ExaminerRole \\\ExaminerDesignation \hfill \ExaminerStatus \\\ExaminerAddress\bigskip
                         
                        
    			}
  \end{minipage}
}




% Thesis candidates' declaration
\def\thesiscandidatesdeclaration{
  \begingroup
  \begin{center}
    \textbf{{\Large\Large  Candidate's Declaration}}
  \end{center}
  \addcontentsline{toc}{chapter}{\textbf{Candidate's Declaration}}
  \vspace*{\stretch{1}}
    
  This is to certify that the work presented in this thesis entitled, ``\thesistitle'', is the outcome of the research carried out by \author{} under the supervision of
  \DTLforeach{Supervisor}{\SupervisorName=Column1,\SupervisorDesignation=Column2}{\SupervisorName}, {\SupervisorDesignation}, Department of Electrical and Electronic Engineering, Bangladesh University of Engineering and Technology (BUET), Dhaka-1205, Bangladesh.

  \bigskip

  It is also declared that neither this thesis nor any part thereof has been submitted anywhere else for the award of any degree, diploma, or other qualifications.
  
  \bigskip
  \bigskip
  \bigskip
  Signature of the Candidate \\
  \bigskip \\
  \bigskip \\
  
    \begin{minipage}[t]{0.4\textwidth}
      \hrule\medskip
      \author\par
      \StudentID
    \end{minipage}\par
 
  \vspace*{\stretch{2}}
  \endgroup
}



% Thesis Dedication page
\def\thesisdedication{
	\begingroup
	\begin{center}
		\textbf{{\Large\Large Dedication}}
	\end{center}
	\addcontentsline{toc}{chapter}{\textbf{Dedication}}
	\input{pages/dedication.tex}
	\endgroup
}



% Inclusion of lof and lot in toc
\RequirePackage[nottoc,notbib]{tocbibind}
\RequirePackage{tocloft}
\RequirePackage{etoolbox}
\newtoggle{suppress@lof}
\newtoggle{suppress@lot}
\newtoggle{suppress@lo@}

\def\suppresslistoffigures{\global\toggletrue{suppress@lof}}
\def\suppresslistoftables{\global\toggletrue{suppress@lot}}
\def\suppresslistofalgorithms{\global\toggletrue{suppress@lo@}}

% ===== ToC / LoF / LoT title font, case, alignment =====
% নামগুলোকে uppercase করি
\renewcommand{\contentsname}{\MakeUppercase{Contents}}
\renewcommand{\listfigurename}{\MakeUppercase{List of Figures}}
\renewcommand{\listtablename}{\MakeUppercase{List of Tables}}

% শিরোনামের ফন্ট: 14pt, bold
\renewcommand{\cfttoctitlefont}{\bfseries\fontsize{14pt}{16pt}\selectfont}
\renewcommand{\cftloftitlefont}{\bfseries\fontsize{14pt}{16pt}\selectfont}
\renewcommand{\cftlottitlefont}{\bfseries\fontsize{14pt}{16pt}\selectfont}

% শিরোনামকে সেন্টার করা
% (tocloft >= v2.3 হলে ...titlealign আছে; না থাকলে after...title দিয়ে কাজ হবে)
\providecommand{\cfttoctitlealign}{}
\providecommand{\cftloftitlealign}{}
\providecommand{\cftlottitlealign}{}
\renewcommand{\cfttoctitlealign}{\hfill}
\renewcommand{\cftloftitlealign}{\hfill}
\renewcommand{\cftlottitlealign}{\hfill}
\renewcommand{\cftaftertoctitle}{\hfill}
\renewcommand{\cftafterloftitle}{\hfill}
\renewcommand{\cftafterlottitle}{\hfill}

% শিরোনামের নিচে স্পেস (ইচ্ছেমতো টিউন করতে পারেন)
\setlength{\cftbeforetoctitleskip}{0pt}
\setlength{\cftaftertoctitleskip}{25pt}
\setlength{\cftbeforeloftitleskip}{0pt}
\setlength{\cftafterloftitleskip}{25pt}
\setlength{\cftbeforelottitleskip}{0pt}
\setlength{\cftafterlottitleskip}{25pt}

\def\listsandtoc{
  % Table of contents
  \tableofcontents

  % List of figures, if not suppressed
  \iftoggle{suppress@lof}{\relax}{
    \cleardoublepage
    {%
      % locally uppercase for heading
      \renewcommand{\listfigurename}{{List of Figures}}%
      \listoffigures
    }%
  }

  % List of tables, if not suppressed
  \iftoggle{suppress@lot}{\relax}{
    \cleardoublepage
    {%
      % locally uppercase for heading
      \renewcommand{\listtablename}{{List of Tables}}%
      \listoftables
    }%
  }

  % List of algorithms, if not suppressed
  %\iftoggle{suppress@lo@}{\relax}{\cleardoublepage
  %  {%
  %    \renewcommand{\listalgorithmname}{\MakeUppercase{List of Algorithms}}%
  %    \addcontentsline{toc}{chapter}{\listalgorithmname}
  %    \listofalgorithms
  %  }%
  %}
}


\def\thesisab{
	%\glsaddall
	\renewcommand{\headrulewidth}{0.0mm}
\renewcommand{\footrulewidth}{0.0mm}
	\printglossary[title={List of Abbreviations}]
    \input{pages/abbr.tex}
}

% Thesis Acknowledgement page
\def\thesisacknowledgement{
	\begingroup
	\begin{center}
  \textbf{\MakeUppercase{\fontsize{14pt}{16pt}\selectfont Acknowledgement}}\\[60pt]
\end{center}
	\addcontentsline{toc}{chapter}{\textbf{Acknowledgement}}
	\input{pages/acknowledgement.tex}

	\endgroup
}

\def\thesisabstract{
	\begingroup
\begin{center}
  \textbf{\MakeUppercase{\fontsize{14pt}{16pt}\selectfont Abstract}}\\[60pt]
\end{center}
	\addcontentsline{toc}{chapter}{\textbf{Abstract}}
		\input{pages/abstract.tex}
	
	\endgroup
}


% Starting materials
\def\st@rtingm@teri@ls{
  \thesistitlepage

  \cleardoublepage
  \pagenumbering{roman}
  \setcounter{page}{2}
  \thesiscertificationpage

  \cleardoublepage
  \thesiscandidatesdeclaration


  \cleardoublepage
  \thesisdedication


  \cleardoublepage
  \listsandtoc
  
  \thesisab
  
  \cleardoublepage
  \thesisacknowledgement
  
  \cleardoublepage
  \thesisabstract
  \cleardoublepage

}
\usepackage{fancyhdr}


% Starting materials
\AtBeginDocument{\st@rtingm@teri@ls
\fancyfoot[C]{\thepage}
\fancyhf{}
\renewcommand{\headrulewidth}{0.0mm}
\renewcommand{\footrulewidth}{0.0mm}

\pagenumbering{arabic}
%\setcounter{page}{1}
\pagestyle{fancy}
\lhead{} %\leftmark
\chead{}
\rhead{}
\cfoot{\thepage}
\lfoot{}
\rfoot{}
\renewcommand{\headrule}{}

 
}

% For index creation
\RequirePackage{imakeidx}

% Chapter title formatting
\RequirePackage{titlesec}


% ---- Chapter ----
\titleformat{\chapter}[block]
  {\bfseries\fontsize{14pt}{16pt}\selectfont\filcenter} % 14pt bold, centered
  {\thechapter.}                                       % number with dot
  {0.5em}                                              % space between number and title
  {\MakeUppercase}                                     % all caps

\titlespacing*{\chapter}{0pt}{-5pt}{25pt}              % spacing before/after

% ---- Unnumbered Chapter (e.g., Abstract, Contents, Acknowledgement) ----
\titleformat{name=\chapter,numberless}[block]
  {\bfseries\fontsize{14pt}{16pt}\selectfont\filcenter} % 14pt bold, centered
  {}                                                    % no number
  {0pt}
  {\MakeUppercase}                                      % all caps text

\titlespacing*{name=\chapter,numberless}{0pt}{-5pt}{25pt}

% ---- Section ----
\titleformat{\section}[block]
  {\bfseries\fontsize{12pt}{14pt}\selectfont}          % 12pt bold
  {\thesection}                                        % number
  {0.5em}
  {}

% ---- Subsection ----
\titleformat{\subsection}[block]
  {\bfseries\fontsize{12pt}{14pt}\selectfont}          % 12pt bold
  {\thesubsection}                                     % number
  {0.5em}
  {}

\AtEndDocument{%
  \clearpage
  \pagestyle{plain}
  
  \begingroup
  
  \flushright

  \vspace*{0.0mm}
  \vfill\vfill\vfill\vfill\vfill
  \sffamily

  Generated using Undegraduate Thesis \LaTeX\xspace Template,
  Version~\rcsInfoRevision. \EEE, \buet, Dhaka, Bangladesh.

  \bigskip

  \settimeformat{ampmtime}

  This thesis was generated on~\today\xspace at~\currenttime.

  \vfill

  \endgroup
  
  \clearpage
% Requires \usepackage{graphicx}
\begin{titlepage}
% Reduce top and bottom margins for this page only
\newgeometry{top=1.0cm,bottom=1.0cm,left=8.5cm,right=8.5cm}
    \centering
\vspace{-2.1cm}
    % === Top horizontal lines ===
    \hrule
    \vspace{0.1cm}
    \hrule

    \vspace{0.25cm}

    % Degree / Dept / Univ block
    \textbf{M.Sc.\\Engg. \\EEE\\BUET}

    \vspace{0.25cm}
    \hrule
    \vspace{0.1cm}
    \hrule

    \vspace{0.5cm}

    % ===============================
    % Rotated TITLE with WRAPPING
    % ===============================
    % Choose a width relative to the page height so the rotated box wraps neatly.
    % You can tune 0.72\textheight if needed.
    \newlength{\TitleBoxW}
    \setlength{\TitleBoxW}{0.55\textheight}

    % The parbox width controls wrapping; 'origin=c' keeps it centered on rotation.
    \rotatebox[origin=c]{270}{%
      \parbox[t]{\TitleBoxW}{\centering\bfseries\fontsize{12}{14}\selectfont
        \setlength{\parindent}{0pt}%
        \thesistitle
      }%
    }

    \vspace{0.0cm}

    % ===============================
    % Rotated AUTHORS with WRAPPING
    % ===============================
    \newlength{\AuthorBoxW}
    \setlength{\AuthorBoxW}{0.20\textheight}

    \rotatebox[origin=c]{270}{%
      \parbox[t]{\AuthorBoxW}{\centering\bfseries\fontsize{12}{6}\selectfont
         \author
      }%
    }

    \vspace{0.2cm}

    % === Bottom horizontal lines ===
    \vfill
    \hrule
    \vspace{0.1cm}
    \hrule

    \vspace{0.25cm}

    % Month / Year (stacked to match style)
    \textbf{ \StrLeft{\thesisdefensemonth}{3} \\ \thesisdefenseyear}

    \vspace{0.35cm}
    \hrule
    \vspace{0.1cm}
    \hrule

    \vfill
\end{titlepage}
  
  }

\endinput
